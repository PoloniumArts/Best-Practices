Git
=============

Руководство по программированию с системой контроля версий.

P.S. В тексте указаны ссылки на документацию GitHub, но описанные
действия аналогичны и для GitLab.

Поддержка репозитория
------------------------

* Избегайте включения в репозиторий файлов специфичных для
вашего окружения или процесса разработки.
* Удаляйте локальную и удаленную ветку функциональности (feature)
после слияния (merging).
* Выполняйте работу в ветке функциональности (feature).
* Часто используйте rebase для включения предыдущих изменений.
* Используйте [pull request] для ревью кода.

[pull request]: https://help.github.com/articles/using-pull-requests/

Написание функциональности
------------------------------

Создайте локальную ветку функциональности (feature) основанную на master.

    git checkout master
    git pull
    git checkout -b <branch-name>

Укажите в качестве префикса имени ветки ваши инициалы (ak - Andrey Krisanov).

Часто используйте rebase для включения предыдущих изменений.

    git fetch origin
    git rebase origin/master

Разрешите конфликты. Когда функциональность завершена и тесты
прошли успешно, примените изменения.

    git add --all

Сделайте коммит.

    git status
    git commit --verbose

Напишите [хорошие сообщения к коммитам]. Пример:

    Общая информация длинной не более 50 символов

    * Более детальная информация (не более 72 символов).
    * Более детальная информация (не более 72 символов).

    http://project.management-system.com/ticket/123
    @akrisanov, обращение к члену комманды

Если вы создали более одного коммита, воспользуйтесь rebase со squash
для их объединения в хорошие коммиты:

    git rebase -i origin/master

Поделитесь вашей веткой.

    git push origin <branch-name>

Отправьте [pull request].

Попросите сделать ревью вашего кода в чате разработки проекта
(приватный канал в Slack).

[хорошие сообщения к коммитам (EN)]: http://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html
[pull request]: https://help.github.com/articles/using-pull-requests/

Ревью кода
-----------

Если вы член команды и не автор pull request, уделите некоторое время
и сделайте ревью изменений коллеги. Следуйте руководству [Ревью кода](/code-review)
для избежания недопонимания.

Напишите комментарии и задавайте вопросы напрямую в веб-интерфейсе
напротив строки кода. При необходимости укажите @user_name для немедленного обращения
к пользователю - он получит уведомление по почте. Менее предпочтительнее
выполнять описанные действия в чате проекта.

Если необходимо внести какие-либо изменения, сделайте check out ветки.

    git checkout <branch-name>
    ./bin/setup
    git diff staging/master..HEAD

Если изменения небольшие, внесите их прямо в ветке, протестируйте
функциональность на своей машине, запустите тесты, напишите коммиты
и отправьте (push) их на сервер.

Когда ревью кода завершено, добавьте комментарий к pull request-у `Ready to merge.`

Слияние (Merge)
----------------

Используйте rebase по назначению. Объедините коммиты с сообщениями
типа "Быстрый фикс" или "Какая-то правка" в один или несколько
ценных коммитов. При необходимости измените сообщения коммитов.
Запустите тесты.

    git fetch origin
    git rebase -i origin/master

Форсируйте push вашей ветки. Это позволит GitHub автоматически
закрыть ваш pull request и пометить его как объединенный когда коммиты
будут отправлены в master. Так же оставит возможность выполнить
[поиск pull request] который привнес ваши изменения.

    git push --force origin <branch-name>

Просмотрите список новых коммитов. Просмотрите измененные файлы.
Слейте ветку в master.

    git log origin/master..<branch-name>
    git diff --stat origin/master
    git checkout master
    git merge <branch-name> --ff-only
    git push

Удалите вашу ветку функциональности на сервере.

    git push origin --delete <branch-name>

Удалите вашу локальную ветку функциональности.

    git branch --delete <branch-name>

[поиск pull request]: http://stackoverflow.com/a/17819027
